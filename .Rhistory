mutate(Pounds.Purchased=as.numeric(Pounds.purchased)) %>%
# Char to date type
mutate(Order.Date=anydate(Order.Date)) %>%
# Rename Order.Date
rename(Order.Amount=Order.Amount....)
# -- Fix misspelled farm names --
farms <- df %>%
select(Farm.Name) %>%
unique() %>%
arrange(Farm.Name)
write.csv(farms,
"Data/Original Data/misspelled_farm_names.csv",
row.names=F)
correct_farms <- read.csv("./Data/Original Data/correct_farm_names.csv")
# Join main df with fixed farm names
df <- df %>%
left_join(correct_farms)
# Remove the old farm names column
df <- df %>%
select(-Farm.Name)
# Rename fixed farm names column to "Farm.Name"
df <- df %>%
rename(Farm.Name="Correct.Farm.Name")
# -- Add coords to the df --
farm_coords <- read_xlsx("./Data/farm_coords.xlsx")
df <- df %>%
left_join(farm_coords)
# Separate coords into lat & long
df <- df %>%
mutate(lat = as.numeric(gsub("^(.*?),.*", "\\1", Coordinates)),
lon = as.numeric(sub("^.*?,", "", Coordinates)))
View(df)
# -- Add Order Month column --
df <- df %>%
mutate(order_month=lubridate::floor_date(Order.Date, "month"))
# -- DF to csv --
write.csv(df, "./Data/dataframe.csv", row.names = F)
write.csv(funds, "./Data/funds_dataframe.csv", row.names = F)
source("C:/Users/starr/Google Drive/Career Projects/Projects/Harvest Against Hunger Summer '21/harvest-against-hunger/Data/Data Compilation.R")
# -- Load packages and data --
load_pckg()
df <- read_csv("Data/dataframe.csv")
funds <- read_csv("Data/funds_dataframe.csv")
# ~~ LINE DATA ~~
# -- Num farms served --
`Number of Farms Served Monthly` <- df %>%
select(Farm.Name, order_date) %>%
unique() %>%
group_by(order_date) %>%
summarize(num_farms=n()) %>%
mutate(cumulative=cumsum(num_farms)) %>%
na.omit()
View(df)
# Rename columns
df <- df %>%
rename(order_date=order_month)
# -- DF to csv --
write.csv(df, "./Data/dataframe.csv", row.names = F)
write.csv(funds, "./Data/funds_dataframe.csv", row.names = F)
source("C:/Users/starr/Google Drive/Career Projects/Projects/Harvest Against Hunger Summer '21/harvest-against-hunger/Data/Original Data/Data Cleaning.R")
source("C:/Users/starr/Google Drive/Career Projects/Projects/Harvest Against Hunger Summer '21/harvest-against-hunger/Data/Data Compilation.R")
source("C:/Users/starr/Google Drive/Career Projects/Projects/Harvest Against Hunger Summer '21/harvest-against-hunger/Data/Original Data/Data Cleaning.R")
View(funds)
source("C:/Users/starr/Google Drive/Career Projects/Projects/Harvest Against Hunger Summer '21/harvest-against-hunger/Data/Original Data/Data Cleaning.R")
source("C:/Users/starr/Google Drive/Career Projects/Projects/Harvest Against Hunger Summer '21/harvest-against-hunger/Data/Original Data/Data Cleaning.R")
warnings()
source("C:/Users/starr/Google Drive/Career Projects/Projects/Harvest Against Hunger Summer '21/harvest-against-hunger/Data/Data Compilation.R")
View(`Total Order Amount ($)`)
View(df)
View(`Total Orders`)
`Total Orders` <- df_map %>%
select(Farm.Name, order_date, lat, lon) %>%
group_by(Farm.Name, lat, lon) %>%
summarize(total=n()) %>%
na.omit()
View(`Total Orders`)
View(`Total Order Amount ($)`)
View(`Total Pounds Purchased`)
# -- Add coords to the df --
# Record coords on excel!!!
old_coords <- farms %>%
full_join(farm_coords)
write.csv(old_coords, "./Data/Original Data/old_coords.csv")
write.csv(old_coords,
"./Data/Original Data/old_coords.csv",
row.names = F)
# -- Compiled 2019-2020 KCFS + CARES data, with pounds purchased fixed --
df <- read.csv("./Data/fix_pounds_purchased.csv") %>%
# Char to num type
mutate(Pounds.Purchased=as.numeric(Pounds.purchased)) %>%
# Char to date type
mutate(Order.Date=anydate(Order.Date)) %>%
# Rename Order.Date
rename(Order.Amount=Order.Amount....)
# -- Fix misspelled farm names --
farms <- df %>%
select(Farm.Name) %>%
unique() %>%
arrange(Farm.Name)
write.csv(farms,
"Data/Original Data/misspelled_farm_names.csv",
row.names=F)
correct_farms <- read.csv("./Data/Original Data/correct_farm_names.csv")
# Join main df with fixed farm names
df <- df %>%
left_join(correct_farms)
# Remove the old farm names column
df <- df %>%
select(-Farm.Name)
# Rename fixed farm names column to "Farm.Name"
df <- df %>%
rename(Farm.Name="Correct.Farm.Name")
# -- Add coords to the df --
# Record coords on excel!!!
old_coords <- farms %>%
full_join(farm_coords)
write.csv(old_coords,
"./Data/Original Data/old_coords.csv",
row.names = F)
View(farms)
View(correct_farms)
# -- Add coords to the df --
# Record coords on excel!!!
old_coords <- correct_farms %>%
full_join(farm_coords)
write.csv(old_coords,
"./Data/Original Data/old_coords.csv",
row.names = F)
View(correct_farms)
# -- Add coords to the df --
# Record coords on excel!!!
correct_farms <- correct_farms %>%
select(Correct.Farm.Name) %>%
rename(Farm.Name=Correct.Farm.Name)
old_coords <- correct_farms %>%
full_join(farm_coords)
write.csv(old_coords,
"./Data/Original Data/old_coords.csv",
row.names = F)
# -- Add coords to the df --
# Record coords on excel!!!
correct_farms <- correct_farms %>%
select(Correct.Farm.Name) %>%
rename(Farm.Name=Correct.Farm.Name) %>%
unique()
correct_farms <- read.csv("./Data/Original Data/correct_farm_names.csv")
# -- Add coords to the df --
# Record coords on excel!!!
correct_farms <- correct_farms %>%
select(Correct.Farm.Name) %>%
rename(Farm.Name=Correct.Farm.Name) %>%
unique()
old_coords <- correct_farms %>%
full_join(farm_coords)
write.csv(old_coords,
"./Data/Original Data/old_coords.csv",
row.names = F)
View(df)
View(farms)
# -- Compiled 2019-2020 KCFS + CARES data, with pounds purchased fixed --
df <- read.csv("./Data/fix_pounds_purchased.csv") %>%
# Char to num type
mutate(Pounds.Purchased=as.numeric(Pounds.purchased)) %>%
# Char to date type
mutate(Order.Date=anydate(Order.Date)) %>%
# Rename Order.Date
rename(Order.Amount=Order.Amount....)
# Join main df with fixed farm names
df <- df %>%
left_join(correct_farms)
View(df)
# Remove the old farm names column
df <- df %>%
select(-Farm.Name)
# Rename fixed farm names column to "Farm.Name"
df <- df %>%
rename(Farm.Name="Correct.Farm.Name")
# -- Compiled 2019-2020 KCFS + CARES data, with pounds purchased fixed --
df <- read.csv("./Data/fix_pounds_purchased.csv") %>%
# Char to num type
mutate(Pounds.Purchased=as.numeric(Pounds.purchased)) %>%
# Char to date type
mutate(Order.Date=anydate(Order.Date)) %>%
# Rename Order.Date
rename(Order.Amount=Order.Amount....)
# Join main df with fixed farm names
df <- df %>%
left_join(correct_farms)
# Join main df with fixed farm names
df <- df %>%
left_join(correct_farms)
correct_farms <- read.csv("./Data/Original Data/correct_farm_names.csv")
# -- Compiled 2019-2020 KCFS + CARES data, with pounds purchased fixed --
df <- read.csv("./Data/fix_pounds_purchased.csv") %>%
# Char to num type
mutate(Pounds.Purchased=as.numeric(Pounds.purchased)) %>%
# Char to date type
mutate(Order.Date=anydate(Order.Date)) %>%
# Rename Order.Date
rename(Order.Amount=Order.Amount....)
# Join main df with fixed farm names
df <- df %>%
left_join(correct_farms)
# Remove the old farm names column
df <- df %>%
select(-Farm.Name)
# Rename fixed farm names column to "Farm.Name"
df <- df %>%
rename(Farm.Name="Correct.Farm.Name")
correct_farms <- read.csv("./Data/Original Data/correct_farm_names.csv")
# Join main df with fixed farm names
df <- df %>%
left_join(correct_farms)
# Remove the old farm names column
df <- df %>%
select(-Farm.Name)
# Rename fixed farm names column to "Farm.Name"
df <- df %>%
rename(Farm.Name="Correct.Farm.Name")
View(farms)
View(correct_farms)
# -- Compiled 2019-2020 KCFS + CARES data, with pounds purchased fixed --
df <- read.csv("./Data/fix_pounds_purchased.csv") %>%
# Char to num type
mutate(Pounds.Purchased=as.numeric(Pounds.purchased)) %>%
# Char to date type
mutate(Order.Date=anydate(Order.Date)) %>%
# Rename Order.Date
rename(Order.Amount=Order.Amount....)
correct_farms <- read.csv("./Data/Original Data/correct_farm_names.csv")
# Join main df with fixed farm names
df <- df %>%
left_join(correct_farms)
# Remove the old farm names column
df <- df %>%
select(-Farm.Name)
# Rename fixed farm names column to "Farm.Name"
df <- df %>%
rename(Farm.Name="Correct.Farm.Name")
# -- Add coords to the df --
# Record coords on excel!!!
correct_farms <- correct_farms %>%
select(Correct.Farm.Name) %>%
rename(Farm.Name=Correct.Farm.Name) %>%
unique()
old_coords <- correct_farms %>%
full_join(farm_coords)
write.csv(old_coords,
"./Data/Original Data/old_coords.csv",
row.names = F)
old_coords <- read.csv("./Data/Original Data/correct_coords.csv")
old_coords <- correct_farms %>%
full_join(old_coords)
write.csv(old_coords,
"./Data/Original Data/old_coords.csv",
row.names = F)
# Load new farm coord data
farm_coords <- read.csv("./Data/Original Data/correct_coords.csv")
df <- df %>%
left_join(farm_coords)
# Separate coords into lat & long
df <- df %>%
mutate(lat = as.numeric(gsub("^(.*?),.*", "\\1", Coordinates)),
lon = as.numeric(sub("^.*?,", "", Coordinates)))
# -- Add Order Month column --
df <- df %>%
mutate(order_month=lubridate::floor_date(Order.Date, "month"))
# Rename columns
df <- df %>%
rename(order_date=order_month)
funds <- funds %>%
rename(order_date=year)
# -- DF to csv --
write.csv(df, "./Data/dataframe.csv", row.names = F)
write.csv(funds, "./Data/funds_dataframe.csv", row.names = F)
# -- DF to csv --
write.csv(df, "./Data/dataframe.csv", row.names = F)
write.csv(funds, "./Data/funds_dataframe.csv", row.names = F)
# -- Load packages and data --
load_pckg()
df <- read_csv("Data/dataframe.csv")
funds <- read_csv("Data/funds_dataframe.csv")
View(df)
# ~~ LINE DATA ~~
# -- Num farms served --
`Number of Farms Served Monthly` <- df %>%
select(Farm.Name, order_date) %>%
unique() %>%
group_by(order_date) %>%
summarize(num_farms=n()) %>%
mutate(cumulative=cumsum(num_farms)) %>%
na.omit()
# -- Num orders --
`Number of Orders Monthly` <- df %>%
select(Farm.Name, order_date) %>%
group_by(order_date) %>%
summarize(num_orders=n()) %>%
mutate(cumulative=cumsum(num_orders)) %>%
na.omit()
# -- Order amount ($) --
`Order Amount ($) Monthly` <- df %>%
select(order_date, Order.Amount) %>%
group_by(order_date) %>%
summarize(`Total Order Amount ($)`=sum(Order.Amount, na.rm=T)) %>%
mutate(cumulative=cumsum(`Total Order Amount ($)`)) %>%
na.omit()
# -- Amount purchased (lb) --
`Pounds Purchased Monthly` <- df %>%
select(order_date, Pounds.Purchased) %>%
group_by(order_date) %>%
summarize(`Total Pounds Purchased`=sum(Pounds.Purchased, na.rm=T)) %>%
mutate(cumulative=cumsum(`Total Pounds Purchased`)) %>%
na.omit()
# -- Funds disbursed ($) --
`Funds Disbursed ($) Yearly` <- funds %>%
group_by(order_date) %>%
summarize(total_funds=sum(funds_dispersed, na.rm = T)) %>%
mutate(cumulative=cumsum(total_funds)) %>%
na.omit()
# ~~ MAP DATA ~~
# -- Set up map --
kingco <- readOGR(dsn="Data/kingco_shapefile/King_County_with_Natural_Shoreline_for_Puget_Sound_and_Lake_Washington___kingsh_area.shp")
wa <- map_data("county", "washington")
# Remove farms with locations that are a) unknown or b) outside of King county.
remove_farms <- c("Lily Fields",
"High & Dry Farm",
"Orange Star Farm",
"Caruso Farm",
"Skylight Farms",
"Lowlands Farm",
"Unknown")
df_map <- df %>%
filter(!(Farm.Name %in% remove_farms))
# -- Total Orders --
`Total Orders` <- df_map %>%
select(Farm.Name, order_date, lat, lon) %>%
group_by(Farm.Name, lat, lon) %>%
summarize(total=n()) %>%
na.omit()
# -- Total Order Amount ($) --
`Total Order Amount ($)` <- df_map %>%
select(Farm.Name, Order.Amount, lat, lon) %>%
group_by(Farm.Name, lat, lon) %>%
summarize(total=sum(Order.Amount, na.rm = T)) %>%
na.omit()
# -- Total Pounds Purchased --
`Total Pounds Purchased` <- df_map %>%
select(Farm.Name, Pounds.Purchased, lat, lon) %>%
group_by(Farm.Name, lat, lon) %>%
summarize(total=sum(Pounds.Purchased, na.rm = T)) %>%
na.omit()
shiny::runApp()
runApp()
df <- read_csv("Data/dataframe.csv")
# -- Load packages and data --
load_pckg()
df <- read_csv("Data/dataframe.csv")
funds <- read_csv("Data/funds_dataframe.csv")
# -- Num farms served --
`Number of Farms Served Monthly` <- df %>%
select(Farm.Name, order_date) %>%
unique() %>%
group_by(order_date) %>%
summarize(num_farms=n()) %>%
mutate(cumulative=cumsum(num_farms)) %>%
na.omit()
# -- Num orders --
`Number of Orders Monthly` <- df %>%
select(Farm.Name, order_date) %>%
group_by(order_date) %>%
summarize(num_orders=n()) %>%
mutate(cumulative=cumsum(num_orders)) %>%
na.omit()
# -- Order amount ($) --
`Order Amount ($) Monthly` <- df %>%
select(order_date, Order.Amount) %>%
group_by(order_date) %>%
summarize(`Total Order Amount ($)`=sum(Order.Amount, na.rm=T)) %>%
mutate(cumulative=cumsum(`Total Order Amount ($)`)) %>%
na.omit()
# -- Amount purchased (lb) --
`Pounds Purchased Monthly` <- df %>%
select(order_date, Pounds.Purchased) %>%
group_by(order_date) %>%
summarize(`Total Pounds Purchased`=sum(Pounds.Purchased, na.rm=T)) %>%
mutate(cumulative=cumsum(`Total Pounds Purchased`)) %>%
na.omit()
# -- Funds disbursed ($) --
`Funds Disbursed ($) Yearly` <- funds %>%
group_by(order_date) %>%
summarize(total_funds=sum(funds_dispersed, na.rm = T)) %>%
mutate(cumulative=cumsum(total_funds)) %>%
na.omit()
# ~~ MAP DATA ~~
# -- Set up map --
kingco <- readOGR(dsn="Data/kingco_shapefile/King_County_with_Natural_Shoreline_for_Puget_Sound_and_Lake_Washington___kingsh_area.shp")
wa <- map_data("county", "washington")
# Remove farms with locations that are a) unknown or b) outside of King county.
remove_farms <- c("Unknown",
"Lily Fields",
"High & Dry Farm",
"Orange Star Farm",
"Caruso Farm",
"Skylight Farms",
"Lowlands Farm",
"Tangled Willows Farm")
df_map <- df %>%
filter(!(Farm.Name %in% remove_farms))
# -- Total Orders --
`Total Orders` <- df_map %>%
select(Farm.Name, order_date, lat, lon) %>%
group_by(Farm.Name, lat, lon) %>%
summarize(total=n()) %>%
na.omit()
# -- Total Order Amount ($) --
`Total Order Amount ($)` <- df_map %>%
select(Farm.Name, Order.Amount, lat, lon) %>%
group_by(Farm.Name, lat, lon) %>%
summarize(total=sum(Order.Amount, na.rm = T)) %>%
na.omit()
# -- Total Pounds Purchased --
`Total Pounds Purchased` <- df_map %>%
select(Farm.Name, Pounds.Purchased, lat, lon) %>%
group_by(Farm.Name, lat, lon) %>%
summarize(total=sum(Pounds.Purchased, na.rm = T)) %>%
na.omit()
shiny::runApp()
# -- DF to csv --
write.csv(df, "./Data/dataframe.csv", row.names = F)
df <- read_csv("Data/dataframe.csv")
# DATA COMPILATION
# -- Load packages and data --
load_pckg()
df <- read_csv("Data/dataframe.csv")
funds <- read_csv("Data/funds_dataframe.csv")
# ~~ LINE DATA ~~
# -- Num farms served --
`Number of Farms Served Monthly` <- df %>%
select(Farm.Name, order_date) %>%
unique() %>%
group_by(order_date) %>%
summarize(num_farms=n()) %>%
mutate(cumulative=cumsum(num_farms)) %>%
na.omit()
# -- Num orders --
`Number of Orders Monthly` <- df %>%
select(Farm.Name, order_date) %>%
group_by(order_date) %>%
summarize(num_orders=n()) %>%
mutate(cumulative=cumsum(num_orders)) %>%
na.omit()
# -- Order amount ($) --
`Order Amount ($) Monthly` <- df %>%
select(order_date, Order.Amount) %>%
group_by(order_date) %>%
summarize(`Total Order Amount ($)`=sum(Order.Amount, na.rm=T)) %>%
mutate(cumulative=cumsum(`Total Order Amount ($)`)) %>%
na.omit()
# -- Amount purchased (lb) --
`Pounds Purchased Monthly` <- df %>%
select(order_date, Pounds.Purchased) %>%
group_by(order_date) %>%
summarize(`Total Pounds Purchased`=sum(Pounds.Purchased, na.rm=T)) %>%
mutate(cumulative=cumsum(`Total Pounds Purchased`)) %>%
na.omit()
# -- Funds disbursed ($) --
`Funds Disbursed ($) Yearly` <- funds %>%
group_by(order_date) %>%
summarize(total_funds=sum(funds_dispersed, na.rm = T)) %>%
mutate(cumulative=cumsum(total_funds)) %>%
na.omit()
# ~~ MAP DATA ~~
# -- Set up map --
kingco <- readOGR(dsn="Data/kingco_shapefile/King_County_with_Natural_Shoreline_for_Puget_Sound_and_Lake_Washington___kingsh_area.shp")
wa <- map_data("county", "washington")
# Remove farms with locations that are a) unknown or b) outside of King county.
remove_farms <- c("Unknown",
"Lily Fields",
"High & Dry Farm",
"Orange Star Farm",
"Caruso Farm",
"Skylight Farms",
"Lowlands Farm",
"Tangled Willows Farm")
df_map <- df %>%
filter(!(Farm.Name %in% remove_farms))
# -- Total Orders --
`Total Orders` <- df_map %>%
select(Farm.Name, order_date, lat, lon) %>%
group_by(Farm.Name, lat, lon) %>%
summarize(total=n()) %>%
na.omit()
# -- Total Order Amount ($) --
`Total Order Amount ($)` <- df_map %>%
select(Farm.Name, Order.Amount, lat, lon) %>%
group_by(Farm.Name, lat, lon) %>%
summarize(total=sum(Order.Amount, na.rm = T)) %>%
na.omit()
# -- Total Pounds Purchased --
`Total Pounds Purchased` <- df_map %>%
select(Farm.Name, Pounds.Purchased, lat, lon) %>%
group_by(Farm.Name, lat, lon) %>%
summarize(total=sum(Pounds.Purchased, na.rm = T)) %>%
na.omit()
runApp()
df <- read_csv("Data/dataframe.csv") %>%
mutate(order_month=lubridate::floor_date(Order.Date, "month"))
source("C:/Users/starr/Google Drive/Career Projects/Projects/Harvest Against Hunger Summer '21/harvest-against-hunger/Data/Data Compilation.R")
df <- read_csv("Data/dataframe.csv") %>%
mutate(order_month=lubridate::floor_date(order_month, "month"))
df <- read_csv("Data/dataframe.csv")
View(df)
