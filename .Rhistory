# order_dates = as.numeric(curr$`Order Date`), origin = "1899-12-30"
list[[i]]$`Order Date` = as.Date(as.numeric(curr$`Order Date`), origin = "1899-12-30")
} else {
# order_dates = curr$`Order Date`
list[[i]]$`Order Date` = as.Date(curr$`Order Date`)
}
# list[[i]]$`Order Date` = as.Date(order_dates)
}
View(list)
list[[1]]$`Order Date`
list[[6]]$`Order Date`
for (i in 1:length(list)) {
curr = list[[i]]
## Order Date to date type
if (typeof(curr$`Order Date`) == "character") {
list[[i]]$`Order Date` = as.Date(
as.numeric(curr$`Order Date`), origin = "1899-12-30")
} else {
list[[i]]$`Order Date` = as.Date(curr$`Order Date`)
}
}
# -- Small Fixes --
## Filter out empty dfs
list <- list[lapply(list, nrow) > 0]
# -- Merge --
df <- rbindlist(list)
View(df)
list <- list %>%
lapply(select, `Farm Name`,
`Order Date`,
`Pounds purchased`,
`Program`,
`Year`)
library(tidyverse)
library(readxl)
library(dplyr)
library(zoo)
library(rlist)
library(data.table)
list <- append(X19_list, X20_list)
## Select relevant columns
list <- list %>%
lapply(select, `Farm Name`,
`Order Date`,
`Pounds purchased`,
`Program`,
`Year`)
## Filter out "Totals"
list <- list %>%
lapply(subset, `Farm Name` != "Totals")
curr = list[[i]]
View(list)
for (i in 1:length(list)) {
curr = list[[i]]
## Order Date to date type
if (typeof(curr$`Order Date`) == "character") {
list[[i]]$`Order Date` = as.Date(
as.numeric(curr$`Order Date`), origin = "1899-12-30")
} else {
list[[i]]$`Order Date` = as.Date(curr$`Order Date`)
}
}
# -- Merge --
df <- rbindlist(list)
# -- Testing Purposes --
View(list[[1]])
View(list)
list[[1]]
# -- Testing purposes --
fix_lbs_purchased <- View(list[[1]])
# -- Testing purposes --
fix_lbs_purchased <- View(list[[1]])
# -- Testing purposes --
fix_lbs_purchased <- list[[1]]
View(fix_lbs_purchased)
# -- Testing purposes --
fix_lbs_purchased <- list[[2]]
# -- Testing purposes --
fix_lbs_purchased <- list[[1]]
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
fix_lbs_purchased <- fix_lbs_purchased %>%  # <- Remove everything after the '='
# and '(' signs (uninclusive)
lapply(gsub, pattern="(.*", "")
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
fix_lbs_purchased <- lapply(gsub, pattern="(.*", "", fix_lbs_purchased) # Remove
?gsub
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
fix_lbs_purchased <- fix_lbs_purchased %>%  # <- Remove everything after the '='
# and '(' signs (uninclusive)
gsub(pattern="(.*", replacement = "")
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
fix_lbs_purchased <- fix_lbs_purchased %>%  # <- Remove everything after the '='
# and '(' signs (uninclusive)
gsub(pattern = "\\(.*", replacement = "")
# -- Testing purposes --
fix_lbs_purchased <- list[[1]]
?select
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
fix_lbs_purchased <- fix_lbs_purchased %>%  # <- Remove everything after the '='
# and '(' signs (uninclusive)
select(`Pounds purchased`) %>%
gsub(pattern = "\\(.*", replacement = "")
# -- Testing purposes --
fix_lbs_purchased <- list[[1]]
fix_lbs_purchased <- fix_lbs_purchased %>%  # <- Remove everything after the '='
# and '(' signs (uninclusive)
select(`Pounds purchased`)
fix_lbs_purchased <- fix_lbs_purchased %>%  # <- Remove everything after the '='
# and '(' signs (uninclusive)
select(`Pounds purchased`) %>%
gsub(pattern = "\\(.*", replacement = "")
# -- Testing purposes --
fix_lbs_purchased <- list[[1]]
fix_lbs_purchased <- fix_lbs_purchased %>%  # <- Remove everything after the '='
# and '(' signs (uninclusive)
select(`Pounds purchased`)
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
fix_lbs_purchased <- fix_lbs_purchased %>%  # <- Remove everything after the '='
# and '(' signs (uninclusive)
select(`Pounds purchased`) %>%
fix_lbs_purchased <- gsub(pattern = "\\(.*", replacement = "", x = fix_lbs_purchased)
fix_lbs_purchased <- gsub(pattern = "\\(.*", replacement = "", x = fix_lbs_purchased)
# -- Testing purposes --
fix_lbs_purchased <- list[[1]]
fix_lbs_purchased <- fix_lbs_purchased %>%  # <- Remove everything after the '='
# and '(' signs (uninclusive)
select(`Pounds purchased`) %>%
apply(gsub(pattern = "\\(.*", replacement = ""))
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
fix_lbs_purchased <- fix_lbs_purchased %>%  # <- Remove everything after the '='
# and '(' signs (uninclusive)
select(`Pounds purchased`) %>%
apply(gsub, pattern = "\\(.*", replacement = "")
fix_lbs_purchased <- fix_lbs_purchased %>%  # <- Remove everything after the '='
# and '(' signs (uninclusive)
select(`Pounds purchased`)
?apply
fix_lbs_purchased <- apply(fix_lbs_purchased, 2, gsub, pattern = "\\(.*", replacement = "")
fix_lbs_purchased <- list[[1]]
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
fix_lbs_purchased <- fix_lbs_purchased %>%  # <- Remove everything after the '='
# and '(' signs (uninclusive)
select(`Pounds purchased`) %>%
apply(2, gsub, pattern="\\(.*", replacement = "")
# -- Testing purposes --
fix_lbs_purchased <- list[[1]]
fix_lbs_purchased$`Pounds purchased` <- fix_lbs_purchased %>%  # <- Remove everything after the '='
# and '(' signs (uninclusive)
select(`Pounds purchased`) %>%
apply(2, gsub, pattern="\\(.*", replacement = "")
# -- Testing purposes --
fix_lbs_purchased <- list[[2]]
select(`Pounds purchased`) %>%
apply(2, gsub, pattern="\\(.*", replacement = "")
fix_lbs_purchased$`Pounds purchased` <- fix_lbs_purchased %>%  # <- Remove everything after the '='
# and '(' signs (uninclusive)
select(`Pounds purchased`) %>%
apply(2, gsub, pattern="\\(.*", replacement = "")
# -- Testing purposes --
fix_lbs_purchased <- list[[2]]
fix_lbs_purchased$`Pounds purchased` <- fix_lbs_purchased %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern="=.*", replacement = "")
remove(fix_lbs_purchased)
# -- Testing purposes --
fix_pp <- df
# -- Testing purposes --
fix_pp <- df
View(fix_pp)
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern="=.*", replacement = "")
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# <- Remove everything after the '=' and '(' signs (uninclusive)
remove <- c("\\(.*", "=.*")
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
library(stringr)
a.vector <- str_remove_all(a.vector, paste(remove, collapse = "|"))
remove <- c("\\(.*", "=.*")
fix_pp <- str_remove_all(fix_pp, paste(remove, collapse = "|"))
# -- Testing purposes --
fix_pp <- df
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# <- Remove everything after the '=' and '(' signs (uninclusive)
remove <- c("\\(.*", "=.*")
fix_pp <- str_remove_all(fix_pp, paste(remove, collapse = "|"))
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# <- Remove everything after the '=' and '(' signs (uninclusive)
remove <- "\\(.*|=.*"
# -- Testing purposes --
fix_pp <- df
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# <- Remove everything after the '=' and '(' signs (uninclusive)
remove <- "\\(.*|=.*"
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# <- Remove everything after the '=' and '(' signs (uninclusive)
remove <- "\\(.*|=.*|$.*"
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# <- Remove everything after the '=' and '(' signs (uninclusive)
remove <- "\\(.*|=.*|\\$.*"
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|[^0-9.-]"
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
# -- Testing purposes --
fix_pp <- df
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|[\\s]"
# -- Testing purposes --
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|\\d"
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|[\\d]"
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|[^0-9.-]"
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
[\\s]
# -- Testing purposes --
fix_pp <- df
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|[\\s]"
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
# -- Testing purposes --
fix_pp <- df
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|\\s"
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|\\s?"
# -- Testing purposes --
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|[^0-9.- ]"
# -- Testing purposes --
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|[^0-9.-]| "
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
# -- Testing purposes --
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|[^0-9.-]|[ ]"
# -- Testing purposes --
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
# -- Testing purposes --
fix_pp <- df
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|[^0-9.-\\s]"
# -- Testing purposes --
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
# -- Testing purposes --
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|[^0-9\\s]"
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
# -- Testing purposes --
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|[^0-9.\\s]"
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
# -- Testing purposes --
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|[^0-9.]|[:space:]"
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
# -- Testing purposes --
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|[^0-9.:space:]"
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
# -- Testing purposes --
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|[[^0-9.][:space:]"
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
# -- Testing purposes --
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|[[^0-9.][:space:]]"
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
# -- Testing purposes --
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|[^0-9.\s]"
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
# -- Testing purposes --
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*|[ +$]"
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
# -- Testing purposes --
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# Remove everything after the '=' and '(' signs (uninclusive). Retain numeric
# and whitespaces.
remove <- "\\(.*|=.*|\\$.*| +$"
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
# -- Testing purposes --
## Add together pounds purchased (remove all non-numeric characters and add
## remaining numbers; there will be some errors, but it's the best solution)
# 1. Remove unnecessary numbers by removing everything after the '=', '(', and
# '$' signs (uninclusive).
remove <- "\\(.*|=.*|\\$.*| +$"
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
?mutate
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
transmute(Rmv_Trailing) %>%
apply(2, gsub, pattern=remove, replacement = "")
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
transmute(Rmv_Trailing=apply(2, gsub, pattern=remove, replacement = ""))
fix_pp$`Pounds purchased` <- fix_pp %>%
transmute(`Pounds purchased` = apply(fix_pp, 2, gsub, pattern=remove, replacement = ""))
fix_pp$`Pounds purchased` <- fix_pp %>%
transmute(`Pounds purchased` = apply(fix_pp$`Pounds purchased`, 2, gsub, pattern=remove, replacement = ""))
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
transmute(`Pounds purchased` = apply(fix_pp$`Pounds purchased`, 2, gsub, pattern=remove, replacement = ""))
apply(fix_pp$`Pounds purchased`, 2, gsub, pattern=remove, replacement = "")
remove <- "\\(.*|=.*|\\$.*| +$"
fix_pp <- df
fix_pp$`Pounds purchased` <- fix_pp %>%
select(`Pounds purchased`) %>%
apply(2, gsub, pattern=remove, replacement = "")
fix_pp <- fix_pp %>%
transmute(`Pounds purchased` = gsub(pattern=remove, replacement = "", fix_pp))
?gsub
fix_pp <- fix_pp %>%
transmute(`Pounds purchased` = gsub(pattern=remove, replacement = "", fix_pp$`Pounds purchased`))
fix_pp <- df
fix_pp <- fix_pp %>%
transmute(`Pounds purchased` = gsub(pattern=remove, replacement = "", fix_pp$`Pounds purchased`))
?transmute
fix_pp <- df
fix_pp <- fix_pp %>%
transmute(`Pounds purchased`=gsub(pattern=remove,
replacement = "",
fix_pp$`Pounds purchased`),
.keep = "all")
fix_pp <- fix_pp %>%
transmute(`Pounds purchased`=gsub(pattern=remove,
replacement = "",
fix_pp$`Pounds purchased`),
.keep = c("all", "used"))
fix_pp <- fix_pp %>%
transmute(`Pounds purchased`=gsub(pattern=remove,
replacement = "",
fix_pp$`Pounds purchased`),
.keep = c("all", "used", "unused", "none"))
fix_pp <- fix_pp %>%
transmute(`Pounds purchased`=gsub(pattern=remove,
replacement = "",
fix_pp$`Pounds purchased`),
.keep = c("all"))
fix_pp <- df
fix_pp <- fix_pp %>%
mutate_at(`Pounds purchased`=gsub(pattern=remove,
replacement = "",
fix_pp$`Pounds purchased`))
?mutate_at
fix_pp <- fix_pp %>%
mutate(`Pounds purchased`=gsub(pattern=remove,
replacement = "",
fix_pp$`Pounds purchased`))
fix_pp <- df
fix_pp <- fix_pp %>%
mutate(`Pounds purchased`=gsub(pattern=remove,
replacement = "",
fix_pp$`Pounds purchased`))
